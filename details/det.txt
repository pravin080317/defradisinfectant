customEvents
| where name == "LAPortalLogin"
| extend 
    userId = tostring(customDimensions.userId),
    userName = tostring(customDimensions.userName),
    userCouncil = tostring(customDimensions.userCouncil),
    isMulti = tostring(customDimensions.isUserRepresentsMultipleCouncil)
| summarize 
    totalLogins = count(),
    councilsUsed = make_set(userCouncil),
    councilCount = dcount(userCouncil)
    by userId, userName, isMulti
| extend userType = iff(isMulti == "true", "Multi-LA", "Normal")
| order by userType, userName


pageViews
| extend 
    userId = tostring(customDimensions.userId),
    userName = tostring(customDimensions.userName),
    userCouncil = tostring(customDimensions.userCouncil),
    isMulti = tostring(customDimensions.isUserRepresentsMultipleCouncil)
| where userId != "Anonymous" and isnotempty(userCouncil)
| summarize 
    pagesViewed = count(),
    councilsUsed = make_set(userCouncil),
    councilCount = dcount(userCouncil)
    by userId, userName, isMulti
| extend userType = iff(isMulti == "true", "Multi-LA", "Normal")
| order by userType, userName
