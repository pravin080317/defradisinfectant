Title:
AI-ISSUE01 – Investigate and Resolve Double-Counting of Login and Page View Events in Application Insights

Description:
Currently, duplicate entries are being recorded in Application Insights for both:

trackPageView()

trackEvent() for "LAPortalTracking" (login/session events)

This leads to over-counting page views and login events, skewing analytics and affecting the accuracy of performance and completion metrics reported via Power BI.

This issue likely stems from:

The Application Insights script being loaded multiple times due to how it’s injected in Power Pages (e.g., duplicated in both web templates and content snippets).

Or trackPageView() being called on both initial load and via an automatic trigger from Traffic Analytics.

Tasks:
Investigate Source of Duplication

Review where the script is injected:

msdyn_TrackCode content snippet (auto-included by Traffic Analytics).

Custom content snippets or web templates where manual script is added.

Consolidate Script Placement

Retain script in only one place (ideally via a controlled web template).

Disable default tracking if needed using disablePageViewTracking: true.

Control trackPageView() Call

Ensure trackPageView() is only called once per page load.

If using SPA or dynamic reloads, use a custom trigger (not on every navigation).

Add Tracking Flag

Add a JS flag to prevent duplicate calls per session:

javascript
Copy
Edit
if (!window.aiPageTracked) {
    appInsights.trackPageView({ name: 'Dashboard' });
    window.aiPageTracked = true;
}
Test in Dev/Staging

Verify that a user visit logs only one page view and login event per session/page.
