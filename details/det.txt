Registration Details (from your screenshot):
Field	Value
Message	Create
Primary Entity	annotation
Event Pipeline Stage	PreOperation (before DB commit)
Execution Mode	Synchronous
Event Handler (Class)	VOAP.Portal.FileUpload.Plugins.Entrypoints.annotation.PreAnnotationCreate
Secure Configuration	SDES Auth details (ClientId, Secret, URL, etc.)


When is the Plugin Fired?
The plugin PreAnnotationCreate is triggered on the Create message for the annotation (note) table at the PreOperation stage.

This means:

As soon as a user uploads a file via the portal, and the portal creates an annotation record (which holds the file as a note/document in Dataverse),

The plugin will run before the annotation is actually saved to the database (PreOperation).


1:N (One-to-Many) relationship setup between:

Primary (One) Table: Portal File Management (voap_portalfilemanagement)

Related (Many) Table: Note (annotation)

Details from the image:
The lookup column on the annotation (note) table is:

Schema name: voap_portalfilemanagement_Annotations

This allows multiple notes (annotations) to be linked to a single Portal File Management record.

What this means for the plugin:
The plugin uses the RegardingObjectId (lookup) on the annotation record to link back to the Portal File Management table.

This relationship is how the annotation "knows" which file upload batch it belongs to (whether bulk upload or evidence upload).

The PreAnnotationCreate plugin you shared earlier leverages this relationship to:

Fetch the related Portal File Management record.

Update or change status on that record (e.g., "Uploaded", "Failed", etc.).

Summary of the relationship logic:
1 Portal File Management record ➡️ many annotations (file attachments, including CSV/XLS uploads and evidence documents).

The annotations are used to store the file temporarily, then the file is processed and sanitized by the plugin before the annotation is committed to Dataverse.
