pageViews
| extend 
    userId = tostring(customDimensions.userId),
    userCouncil = tostring(customDimensions.userCouncil)
| where userId != "Anonymous" and userCouncil != "Unknown" and isnotempty(userCouncil)
| summarize distinctCouncils = make_set(userCouncil), count = count() by userId
| extend numCouncils = array_length(distinctCouncils)
| where numCouncils > 1
| project userId, numCouncils, distinctCouncils, count
| order by numCouncils desc


pageViews
| extend 
    userId = tostring(customDimensions.userId),
    sessionId = tostring(customDimensions.sessionId),
    userCouncil = tostring(customDimensions.userCouncil)
| where userId != "Anonymous" and userCouncil != "Unknown" and isnotempty(userCouncil)
| summarize councilsUsed = make_set(userCouncil), numCouncils = dcount(userCouncil) by userId, sessionId
| where numCouncils > 1
| order by userId, sessionId
