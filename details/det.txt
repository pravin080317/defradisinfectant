function sortTable(n, isDate) {
  var table = document.getElementById('{{ tableid }}');
  var rows = table.tBodies[0].rows;
  var switching = true;
  var dir = 'asc';
  var switchcount = 0;

  resetSortArrows();

  while (switching) {
    switching = false;
    for (var i = 0; i < rows.length - 1; i++) {
      var shouldSwitch = false;
      var x = rows[i].getElementsByTagName("td")[n];
      var y = rows[i + 1].getElementsByTagName("td")[n];

      var xVal = x.innerText.toLowerCase();
      var yVal = y.innerText.toLowerCase();

      if (dir === 'asc') {
        document.getElementsByClassName('govuk-table_header')[n].setAttribute('aria-sort', 'ascending');

        if (isDate) {
          if (new Date(xVal) > new Date(yVal)) {
            shouldSwitch = true;
            break;
          }
        } else {
          if (xVal > yVal) {
            shouldSwitch = true;
            break;
          }
        }
      } else if (dir === 'desc') {
        document.getElementsByClassName('govuk-table_header')[n].setAttribute('aria-sort', 'descending');

        if (isDate) {
          if (new Date(xVal) < new Date(yVal)) {
            shouldSwitch = true;
            break;
          }
        } else {
          if (xVal < yVal) {
            shouldSwitch = true;
            break;
          }
        }
      }
    }

    if (shouldSwitch) {
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
      switchcount++;
    } else {
      if (switchcount === 0 && dir === 'asc') {
        dir = 'desc';
        switching = true;
      }
    }
  }

  currentPage = 1;
  displayTable();
  generatePagination();
}
